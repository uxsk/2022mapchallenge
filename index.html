  <head>
    <style> body { margin: 0; } </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <link rel="icon" href="favicon.png" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    
    <title>#30DayMapChallenge by Kontur.io</title>
    <meta name="description" content="Australia waste export 2021-2022">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta property="og:image" content="30daymapchallenge-19.png">
    <meta property="og:image:width" content="1920">
    <meta property="og:image:height" content="1080">
    <meta property="og:image:type" content="image/png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@KonturInc">
    
    
    <script src="//unpkg.com/d3-dsv"></script>
    <script src="//unpkg.com/index-array-by"></script>
    <script src="//unpkg.com/globe.gl"></script>
    <script src="//unpkg.com/three"></script>
    <!--<script src="../../dist/react-globe.gl.js"></script>-->
  </head>

  <body>
  <div id="globeViz"></div>
  <div id="logo">
    <a href="https://kontur.io" target="_blank">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 307.52 84.26"><g id="svglogo"><path class="cls-1" d="M4.26,59.62H1.32A1.32,1.32,0,0,1,0,58.31v-57A1.32,1.32,0,0,1,1.32,0H276.77a1.32,1.32,0,0,1,1.32,1.32V4.26a1.32,1.32,0,0,1-1.32,1.32H6.11a.53.53,0,0,0-.53.53v52.2A1.32,1.32,0,0,1,4.26,59.62Z"></path><path class="cls-1" d="M301.94,26v52.2a.52.52,0,0,1-.53.52H30.75A1.32,1.32,0,0,0,29.43,80v2.94a1.32,1.32,0,0,0,1.32,1.32H306.2a1.32,1.32,0,0,0,1.32-1.32V26a1.32,1.32,0,0,0-1.32-1.32h-2.94A1.32,1.32,0,0,0,301.94,26Z"></path><path class="cls-1" d="M138.73,53.59l-9.42-26.48a3.71,3.71,0,0,0-3.51-2.48h-6a3.72,3.72,0,0,0-3.73,3.72V57.73a1.9,1.9,0,0,0,1.9,1.9h2.94a1.9,1.9,0,0,0,1.9-1.9V42.83h0v-12a.53.53,0,0,1,1-.18l9.42,26.51a3.74,3.74,0,0,0,3.53,2.49h6a3.74,3.74,0,0,0,3.74-3.74V42.83h0V26.53a1.91,1.91,0,0,0-1.9-1.9h-3a1.9,1.9,0,0,0-1.9,1.9V53.41A.53.53,0,0,1,138.73,53.59Z"></path><path class="cls-1" d="M100.85,37.57a16,16,0,0,0-.87-5.22A12.88,12.88,0,0,0,97.47,28c-4.93-5.58-18.74-5.58-23.68,0a12.71,12.71,0,0,0-2.51,4.31,16,16,0,0,0-.87,5.22h0v9.12h0a16,16,0,0,0,.87,5.22,12.78,12.78,0,0,0,2.51,4.31c4.93,5.59,18.74,5.59,23.68,0A12.78,12.78,0,0,0,100,51.91a16,16,0,0,0,.87-5.22h0V37.57Zm-6.65,8a13,13,0,0,1-.43,3.33h0c-1.81,7-14.47,7-16.32,0a13.18,13.18,0,0,1-.41-3.06V38.73a13.41,13.41,0,0,1,.42-3.34h0c1.81-7.05,14.47-7,16.32,0a13.19,13.19,0,0,1,.41,3.07Z"></path><path class="cls-1" d="M162,31.19h9.15a1,1,0,0,1,1.05,1.05V57.73a1.9,1.9,0,0,0,1.9,1.9h2.77a1.9,1.9,0,0,0,1.9-1.9V32.24a1,1,0,0,1,1.05-1.05H189a1.9,1.9,0,0,0,1.89-1.9V26.52A1.89,1.89,0,0,0,189,24.63H162a1.89,1.89,0,0,0-1.89,1.89v2.77A1.9,1.9,0,0,0,162,31.19Z"></path><path class="cls-1" d="M270.19,51.32a1,1,0,0,1,.34-1.66,13.09,13.09,0,0,0,7.79-13.32c-.66-6.47-7-11.71-13.51-11.71H250.89a1.9,1.9,0,0,0-1.9,1.89V57.73a1.9,1.9,0,0,0,1.9,1.9h2.94a1.9,1.9,0,0,0,1.9-1.9V51.81a1.06,1.06,0,0,1,1-1.06h2.6a4.31,4.31,0,0,1,3.18,1.4l5.9,6.42a3.25,3.25,0,0,0,2.41,1.06h3.95a1.32,1.32,0,0,0,1-2.21ZM265.14,44h-8.36a1,1,0,0,1-1-1V32.42a1.06,1.06,0,0,1,1.06-1.06l8.53,0A6.33,6.33,0,0,1,271.5,39,6.43,6.43,0,0,1,265.14,44Z"></path><path class="cls-1" d="M51.15,25.67l-12.83,14a.69.69,0,0,1-1.19-.47V26.52a1.9,1.9,0,0,0-1.9-1.89H32.28a1.89,1.89,0,0,0-1.89,1.89V57.73a1.9,1.9,0,0,0,1.89,1.9h2.95a1.9,1.9,0,0,0,1.89-1.9V50.89a3.68,3.68,0,0,1,.54-1.37,3.82,3.82,0,0,1,5.69.07l7.8,8.91a3.29,3.29,0,0,0,2.47,1.12h3.9a1.32,1.32,0,0,0,1-2.21L45.1,42.84a1.06,1.06,0,0,1,0-1.43L58.49,26.82a1.32,1.32,0,0,0-1-2.21H53.58A3.35,3.35,0,0,0,51.15,25.67Z"></path><path class="cls-1" d="M231.89,24.63h-2.84a1.9,1.9,0,0,0-1.9,1.89s0,19,0,19a13.17,13.17,0,0,1-.42,3.31h0c-1.81,7-14.47,7-16.32,0a13.18,13.18,0,0,1-.41-3.06V26.52a1.89,1.89,0,0,0-1.89-1.89h-2.85a1.9,1.9,0,0,0-1.9,1.89V46.63a16.06,16.06,0,0,0,.87,5.28,12.64,12.64,0,0,0,2.52,4.31c4.94,5.59,18.74,5.59,23.67,0a12.62,12.62,0,0,0,2.51-4.31,16.06,16.06,0,0,0,.87-5.28V26.52A1.89,1.89,0,0,0,231.89,24.63Z"></path></g></svg>
    </a>
  </div>
  <div id="footer">
    <!-- <h1>Australian waste export in Jul 2021 - Jun 2022</h1> -->
    <h1>7 440 070 tonnes of waste </br>were exported by Australia from Jul 2021 - Jun 2022</h1>
    <p>Almost half of the waste was imported by three countries: Indonesia, India, and Vietnam.</br>
    The most popular categories are Metals (60%) and Paper&Cardboard (25%).</br>
    Exported waste value is $4 480 520 087. </p>
    <small>Waste export data is taken from <a href="https://www.dcceew.gov.au/">dcceew.gov.au</a>. </small>
    <small>Many thanks to Tom Patterson for Earth textures <a href="https://shadedrelief.com">shadedrelief.com</a></small>
  </div>

  <style>
    #logo {
    width: 140px;
    position: absolute;
    top: 40px;
    left: 40px;
    color: #fff;
  }
  #svglogo{
    fill:#26ABFF;
  }
  #footer {
    position: absolute;
    bottom: 40px;
    left: 40px;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    color: #fff;
  }
  #footer a{
    color:#aaa;
  }
  h1{
    font-size: 2vw;
  }
  p{
    font-size: 1vw;
    line-height: 1.5em;
  }
  small{
    color: #aaa;
    font-size: 0.8vw;
  }
  </style>
  <script>
    const COUNTRY = 'Australia';
    const OPACITY = 0.2;
    const STROKE = 1;

    const myGlobe = Globe()
      (document.getElementById('globeViz'))
      .globeImageUrl('5_night_8k.jpeg')
      .bumpImageUrl("elev_bump_8k.jpeg")
      .backgroundImageUrl("night-sky.png")
      .atmosphereAltitude("0.15")
      .pointOfView({ lat: -10.4878279, lng: 105.6329821, altitude: 2 })
      .showAtmosphere(true) 
      .atmosphereColor("#3a228a")

      .arcLabel(d => `${d.country}, ${d.tonnes} tonnes `)
      .arcStartLat(+(-25.7349684916223))
      .arcStartLng(+(134.489562606981))
      .arcEndLat(d => +d.lat)
      .arcEndLng(d => +d.lng)
      .arcDashLength(0.5)
      .arcDashGap(0.15)
      .arcDashInitialGap(() => Math.random())
      .arcDashAnimateTime(3000)
      .arcColor(d => [`rgba(0, 255, 0, ${OPACITY})`, `rgba(38, 171, 255, ${OPACITY})`])
      .arcsTransitionDuration(4000)
      .arcStroke(0.3)
      .onArcHover(hoverArc => myGlobe
        .arcColor(d => {
          const op = !hoverArc ? OPACITY : d === hoverArc ? 0.9 : OPACITY / 4;
          return [`rgba(0, 255, 0, ${op})`, `rgba(38, 171, 255, ${op})`];
        })
      )
      // .onArcClick(arcClicked, click, { arcEndLat, arcEndLng, 2 })
      // .onArcClick(clickArc => myGlobe
      //   .pointOfView(d => { 
      //       // lat: -10.4878279, lng: 105.6329821, altitude: 2; 
      //       console.log("jdj");
      //     })
      //   )
      
      
      .pointColor(() => '#26ABFF')
      .pointAltitude(0.004)
      .pointRadius(d => {
        const sqrt = Math.sqrt(d.tonnes)*0.003;
        if (sqrt >= 0.2) { return sqrt; }
        if (sqrt < 0.2) { return 0.3; }
      })
      .pointsMerge(true)
      .pointLabel(d => `${d.country}, ${d.tonnes} tonnes `)
      .pointResolution(6)

    // scene.fog = new THREE.Fog(0x535ef3, 220, 260);
    

    const countryParse = ([countryId, country, lat, lng, tonnes]) => ({ countryId, country, lat, lng, tonnes });

    //load data
    Promise.all([        
      fetch('export.csv')
        .then(res => res.text())
        .then(d => d3.csvParseRows(d, countryParse))
    ])
    .then(([countries]) => {
      myGlobe
      .pointsData(countries)
      .arcsData(countries);
    });

    // const globeMaterial = myGlobe.globeMaterial();
    // globeMaterial.bumpScale = 1;
    // new THREE.TextureLoader().load('water_8k.png', texture => {
    //   globeMaterial.specularMap = texture;
    //   globeMaterial.specular = new THREE.Color('#fff');
    //   globeMaterial.shininess = 1;
    //   // globeMaterial.emissive = new THREE.Color('#220038');
    //   // globeMaterial.emissiveIntensity = 10;
    // });
    
    setTimeout(() => { // wait for scene to be populated (asynchronously)
      //light
      // const ddirectionalLight = new THREE.DirectionalLight( 0xffffff, 1 );
      // ddirectionalLight.position.set(-10,-10,20);
      // ddirectionalLight.target.position.set(10,0,20);
      // scene.add( ddirectionalLight );

      const hemilight = new THREE.HemisphereLight( 0x080820, 0xffffbb, 0.5 );
      scene.add( hemilight );

      // const dLight = new THREE.DirectionalLight(0xffffff, 0.8);
      // dLight.position.set(-2, -2, 4);
      // scene.add(dLight);

    });
  </script>
  </body>
